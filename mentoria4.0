<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Aplicación Interactiva</title>
<style>
  body { margin:0; font-family: Arial, sans-serif; background:#111; color:white; }
  .center { display:flex; justify-content:center; align-items:center; height:100vh; }
  #portada { font-size:2rem; }
  #galeria, #codigoPage { display:none; }
  .galeria-container { position:relative; width:90%; max-width:600px; margin:auto; }
  .galeria-container img { width:100%; border-radius:8px; }
  .arrow { position:absolute; top:50%; transform:translateY(-50%); font-size:2rem; cursor:pointer; user-select:none; }
  .left { left:10px; }
  .right { right:10px; }
  #codigoPage { text-align:center; margin-top:50px; }
  #inputs { display:flex; justify-content:center; gap:10px; margin-top:20px; }
  .digit { width:50px; padding:10px; font-size:2rem; text-align:center; }
  #timer { margin-top:20px; font-size:2rem; }
</style>
</head>
<body>

<div id="portada" class="center">Portada - Espera 10 segundos...</div>

<div id="galeria" class="center">
  <div class="galeria-container">
    <span class="arrow left" onclick="prevImg()">&#8592;</span>
    <img id="imgDisplay" src="img1.jpg" alt="Imagen" />
    <span class="arrow right" onclick="nextImg()">&#8594;</span>
  </div>
</div>

<div id="codigoPage">
  <h1>Introduce los 7 códigos (4 cifras cada uno)</h1>
  <div id="inputs"></div>
  <div id="timer">00:00</div>
</div>

<script>
let portada = document.getElementById('portada');
let galeria = document.getElementById('galeria');
let codigoPage = document.getElementById('codigoPage');

// --- Portada temporizada ---
setTimeout(() => {
  portada.style.display = 'none';
  galeria.style.display = 'flex';
}, 10000);

// --- Galería de imágenes ---
let imgs = ['img1.jpg','img2.jpg','img3.jpg'];
let index = 0;
let imgDisplay = document.getElementById('imgDisplay');

function nextImg(){ index = (index+1) % imgs.length; imgDisplay.src = imgs[index]; }
function prevImg(){ index = (index-1+imgs.length) % imgs.length; imgDisplay.src = imgs[index]; }

galeria.addEventListener('click', () => {
  // pasar a página de códigos cuando el usuario salga de la galería
  galeria.style.display = 'none';
  codigoPage.style.display = 'block';
});

// --- Códigos y cronómetro ---
let inputsDiv = document.getElementById('inputs');
let totalCodigos = 7;
let actual = 0;
let timer = document.getElementById('timer');
let startTime = null;
let interval = null;

for(let i=0;i<totalCodigos;i++){
  let input = document.createElement('input');
  input.className = 'digit';
  input.maxLength = 4;
  input.dataset.index = i;
  input.oninput = validarInput;
  inputsDiv.appendChild(input);
}

function validarInput(e){
  let inp = e.target;
  if(!startTime){ iniciarCronometro(); }

  if(inp.value.length === 4){
    let next = parseInt(inp.dataset.index) + 1;
    if(next < totalCodigos){
      document.querySelector(`input[data-index='${next}']`).focus();
    } else {
      detenerCronometro();
    }
  }
}

function iniciarCronometro(){
  startTime = Date.now();
  interval = setInterval(() =>{
    let diff = Date.now() - startTime;
    let s = Math.floor(diff/1000);
    let m = Math.floor(s/60);
    s = s%60;
    timer.textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  }, 500);
}

function detenerCronometro(){
  clearInterval(interval);
}

</script>

</body>
</html>
